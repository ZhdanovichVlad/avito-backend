# Сервис проведения тендеров

## Описание проекта

Данный проект создан в рамках тестового задания для стажировки на позицию Golang разработчика в компании Авито. Это HTTP API, которое позволяет бизнесам создавать тендеры на услуги, а пользователи или другие компании могут предлагать свои условия для участия в тендере. Полное техническое задание находится в директории "задание".

Проект построен на основе REST API, а данные хранятся в базе данных PostgreSQL.

Проект располагается в директории backend. Остальные директории относятся к условиям тестового задания.

## Структура проекта
```
├───cmd
└───internal
    ├───config                             # Директория для загрузки переменных окружения
    ├───handlers                           # Директория обработчиков
    │   ├───get                            # Обработчики GET-запросов
    │   │   ├───bidstatus                  # Получение статуса предложения /api/bids/{bidId}/status
    │   │   ├───mybids                     # Получение списка ваших предложений /api/bids/my
    │   │   ├───mytenders                  # Получение тендеров пользователя /api/tenders/my
    │   │   ├───ping                       # Проверка доступности сервера /api/ping
    │   │   ├───tenderbids                 # Получение списка предложений для тендера /api/bids/{tenderId}/list
    │   │   ├───tenders                    # Получение списка тендеров /api/tenders
    │   │   └───tenderstatus               # Получение статуса тендера /api/tenders/{tenderId}/status
    │   ├───notfound                       # Обработчик ошибок для незарегистрированных маршрутов
    │   ├───patch                          # Обработчики PATCH-запросов
    │   │   ├───editbid                    # Редактирование предложения /api/bids/{bidId}/edit
    │   │   └───edittender                 # Редактирование тендера /api/tenders/{tenderId}/edit
    │   ├───post                           # Обработчики POST-запросов
    │   │   ├───newbid                     # Создание нового предложения /api/bids/new
    │   │   └───newtender                  # Создание нового тендера /api/tenders/new
    │   └───put                            # Обработчики PUT-запросов
    │       ├───bidfeedback
    │       ├───changebidstatus            # Изменение статуса предложения /api/bids/{bidId}/status           
    │       ├───changetenderstatus         # Изменение статуса тендера /api/tenders/{tenderId}/status         
    │       ├───rollbackbid                # Откат версии предложения /api/bids/{bidId}/rollback/{version}
    │       └───rollbacktender             # Откат версии тендера /api/tenders/{tenderId}/rollback/{version}
    ├───http
    │   └───router                         # Регистрация обработчиков
    ├───lib                                # Внутренние модели и функции
    │   ├───api                            # Бизнес-логика
    │   │   ├───limitandoffsetcheck        # Валидация limit и offset
    │   │   ├───response                   # Отправка ошибок и логирование
    │   │   ├───typecheck                  # Валидация типовых данных
    │   │   └───versionvalidation          # Валидация версий
    │   └───models                         # Основные структуры и методы
    ├───middleware                         # Middleware
    │   └───log                            # Логирование запросов
    └───storage                            # Работа с базой данных
```

## Инструкция по запуску кода локально

### Предварительные условия

- Go версии 1.23 и выше
- PostgreSQL
- Наличие таблиц employee, organization, и связь между ними в таблице organization_type в базе данных. 
### Настройка .env

Создайте системные переменные окружения или локальные переменные окружения (файл `.env`) в корне проекта со следующим содержимым:

```
SERVER_ADDRESS    —  адрес и порт, который будет слушать HTTP сервер при запуске. Пример: 0.0.0.0:8080.
POSTGRES_USERNAME —  имя пользователя для подключения к PostgreSQL.
POSTGRES_PASSWORD —  пароль для подключения к PostgreSQL.
POSTGRES_HOST     —  хост для подключения к PostgreSQL (например, localhost).
POSTGRES_PORT     —  порт для подключения к PostgreSQL (например, 5432).
POSTGRES_DATABASE —  имя базы данных PostgreSQL, которую будет использовать приложение.
```

### Запуск приложения

1. Установите зависимости командой:

```sh
go mod download
```

2. Запустите приложение:

```sh
go run main.go            "# Использует системные переменные окружения"
```
```sh
go run main.go -env=local "# Использует переменные из файла .env"
```

Приложение будет доступно по адресу http://0.0.0.0:8080 

## Cборка и запуск проекта через Docker

1. Выполните сборку Docker образа командой:

```sh
docker build "Имя проекта" .
```

2. Запустите Docker контейнер командой:

```sh
docker run "Имя проекта"
```

Примечание: Docker по умолчанию использует системные переменные окружения для подключения к базе данных.

### Идеи для улучшения проекта.
1) Реализовать трёхслойную архитектуру для улучшения структуры проекта.
2) Добавить логику отзывов для предложений.
3) Запретить сотрудникам компании, создавшей тендер, подавать предложения на собственный тендер. Эта идея выходит за рамки технического задания и была предложена мной как дополнительное улучшение.




#### Благодарность
## Спасибо за внимание
